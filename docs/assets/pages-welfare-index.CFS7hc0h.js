var e,t,s,i;import{o as a,c as l,w as r,g as n,t as o,m as d,p as u,q as c,j as p,b as h,d as f,s as _,e as b,F as g,f as v,i as m,v as y,a as w,r as x,h as S,k as $,n as k}from"./index-Dyrxeott.js";import{m as C,a as T}from"./mixin.BiGwPJh4.js";import{_ as B}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{r as N}from"./uni-app.es.Cyaz7D0q.js";const R={props:{isDot:{type:Boolean,default:!1},value:{type:[Number,String],default:""},show:{type:Boolean,default:!0},max:{type:[Number,String],default:999},type:{type:[String,void 0,null],default:"error"},showZero:{type:Boolean,default:!1},bgColor:{type:[String,null],default:null},color:{type:[String,null],default:null},shape:{type:[String,void 0,null],default:"circle"},numberType:{type:[String,void 0,null],default:"overflow"},offset:{type:Array,default:()=>[]},inverted:{type:Boolean,default:!1},absolute:{type:Boolean,default:!1},...null==(t=null==(e=uni.$uv)?void 0:e.props)?void 0:t.badge}};const L=B({name:"uv-badge",mixins:[C,T,R],computed:{boxStyle:()=>({}),badgeStyle(){const e={};if(this.color&&(e.color=this.color),this.bgColor&&!this.inverted&&(e.backgroundColor=this.bgColor),this.absolute&&(e.position="absolute",this.offset.length)){const t=this.offset[0],s=this.offset[1]||t;e.top=this.$uv.addUnit(t),e.right=this.$uv.addUnit(s)}return e},showValue(){switch(this.numberType){case"overflow":return Number(this.value)>Number(this.max)?this.max+"+":this.value;case"ellipsis":return Number(this.value)>Number(this.max)?"...":this.value;case"limit":return Number(this.value)>999?Number(this.value)>=9999?Math.floor(this.value/1e4*100)/100+"w":Math.floor(this.value/1e3*100)/100+"k":this.value;default:return Number(this.value)}},propsType(){return this.type||"error"}}},[["render",function(e,t,s,i,h,f){const _=p;return e.show&&(0!==Number(e.value)||e.showZero||e.isDot)?(a(),l(_,{key:0,class:d([[e.isDot?"uv-badge--dot":"uv-badge--not-dot",e.inverted&&"uv-badge--inverted","horn"===e.shape&&"uv-badge--horn",`uv-badge--${f.propsType}${e.inverted?"--inverted":""}`],"uv-badge"]),style:u([e.$uv.addStyle(e.customStyle),f.badgeStyle])},{default:r((()=>[n(o(e.isDot?"":f.showValue),1)])),_:1},8,["class","style"])):c("",!0)}],["__scopeId","data-v-8c3e535e"]]);const D=B({name:"uv-tabs",emits:["click","change"],mixins:[C,T,{props:{duration:{type:Number,default:300},list:{type:Array,default:()=>[]},lineColor:{type:String,default:"#3c9cff"},activeStyle:{type:[String,Object],default:()=>({color:"#303133"})},inactiveStyle:{type:[String,Object],default:()=>({color:"#606266"})},lineWidth:{type:[String,Number],default:20},lineHeight:{type:[String,Number],default:3},lineBgSize:{type:String,default:"cover"},itemStyle:{type:[String,Object],default:()=>({height:"44px"})},scrollable:{type:Boolean,default:!0},current:{type:[Number,String],default:0},keyName:{type:String,default:"name"},...null==(i=null==(s=uni.$uv)?void 0:s.props)?void 0:i.tabs}}],data:()=>({firstTime:!0,scrollLeft:0,scrollViewWidth:0,lineOffsetLeft:0,tabsRect:{left:0},innerCurrent:0,moving:!1}),watch:{current:{immediate:!0,handler(e,t){e!==this.innerCurrent&&(this.innerCurrent=e,this.$nextTick((()=>{this.resize()})))}},list(){this.$nextTick((()=>{this.resize()}))}},computed:{textStyle(){return e=>{const t={},s=e==this.innerCurrent?this.$uv.addStyle(this.activeStyle):this.$uv.addStyle(this.inactiveStyle);return this.list[e].disabled&&(t.color="#c8c9cc"),this.$uv.deepMerge(s,t)}},propsBadge:()=>R},async mounted(){this.init()},methods:{setLineLeft(){const e=this.list[this.innerCurrent];if(!e)return;let t=this.list.slice(0,this.innerCurrent).reduce(((e,t)=>e+t.rect.width),0),s=this.$uv.getPx(this.lineWidth);this.$uv.test.number(this.lineWidth)&&this.$uv.unit&&(s=this.$uv.getPx(`${this.lineWidth}${this.$uv.unit}`)),this.lineOffsetLeft=t+(e.rect.width-s)/2,this.firstTime&&setTimeout((()=>{this.firstTime=!1}),20)},animation(e,t=0){},clickHandler(e,t){this.$emit("click",{...e,index:t}),e.disabled||(this.innerCurrent!=t&&this.$emit("change",{...e,index:t}),this.innerCurrent=t,this.$nextTick((()=>{this.resize()})))},init(){this.$uv.sleep().then((()=>{this.resize()}))},setScrollLeft(){const e=this.list[this.innerCurrent],t=this.list.slice(0,this.innerCurrent).reduce(((e,t)=>e+t.rect.width),0),s=this.$uv.sys().windowWidth;let i=t-(this.tabsRect.width-e.rect.width)/2-(s-this.tabsRect.right)/2+this.tabsRect.left/2;i=Math.min(i,this.scrollViewWidth-this.tabsRect.width),this.scrollLeft=Math.max(0,i)},resize(){0!==this.list.length&&Promise.all([this.getTabsRect(),this.getAllItemRect()]).then((([e,t=[]])=>{this.tabsRect=e,this.scrollViewWidth=0,t.map(((e,t)=>{this.scrollViewWidth+=e.width,this.list[t].rect=e})),this.setLineLeft(),this.setScrollLeft()}))},getTabsRect(){return new Promise((e=>{this.queryRect("uv-tabs__wrapper__scroll-view").then((t=>e(t)))}))},getAllItemRect(){return new Promise((e=>{const t=this.list.map(((e,t)=>this.queryRect(`uv-tabs__wrapper__nav__item-${t}`,!0)));Promise.all(t).then((t=>e(t)))}))},queryRect(e,t){return new Promise((t=>{this.$uvGetRect(`.${e}`).then((e=>{t(e)}))}))}}},[["render",function(e,t,s,i,c,w){const x=p,S=N(h("uv-badge"),L),$=m,k=y;return a(),l($,{class:"uv-tabs",style:u([e.$uv.addStyle(e.customStyle)])},{default:r((()=>[f($,{class:"uv-tabs__wrapper"},{default:r((()=>[_(e.$slots,"left",{},void 0,!0),f($,{class:"uv-tabs__wrapper__scroll-view-wrapper"},{default:r((()=>[f(k,{"scroll-x":e.scrollable,"scroll-left":c.scrollLeft,"scroll-with-animation":"",class:"uv-tabs__wrapper__scroll-view","show-scrollbar":!1,ref:"uv-tabs__wrapper__scroll-view"},{default:r((()=>[f($,{class:"uv-tabs__wrapper__nav",ref:"uv-tabs__wrapper__nav",style:u({flex:e.scrollable?"":1})},{default:r((()=>[(a(!0),b(g,null,v(e.list,((t,s)=>(a(),l($,{class:d(["uv-tabs__wrapper__nav__item",[`uv-tabs__wrapper__nav__item-${s}`,t.disabled&&"uv-tabs__wrapper__nav__item--disabled"]]),key:s,onClick:e=>w.clickHandler(t,s),ref_for:!0,ref:`uv-tabs__wrapper__nav__item-${s}`,style:u([{flex:e.scrollable?"":1},e.$uv.addStyle(e.itemStyle)])},{default:r((()=>[f(x,{class:d([[t.disabled&&"uv-tabs__wrapper__nav__item__text--disabled"],"uv-tabs__wrapper__nav__item__text"]),style:u([w.textStyle(s)])},{default:r((()=>[n(o(t[e.keyName]),1)])),_:2},1032,["class","style"]),f(S,{show:!(!t.badge||!(t.badge.show||t.badge.isDot||t.badge.value)),isDot:t.badge&&t.badge.isDot||w.propsBadge.isDot,value:t.badge&&t.badge.value||w.propsBadge.value,max:t.badge&&t.badge.max||w.propsBadge.max,type:t.badge&&t.badge.type||w.propsBadge.type,showZero:t.badge&&t.badge.showZero||w.propsBadge.showZero,bgColor:t.badge&&t.badge.bgColor||w.propsBadge.bgColor,color:t.badge&&t.badge.color||w.propsBadge.color,shape:t.badge&&t.badge.shape||w.propsBadge.shape,numberType:t.badge&&t.badge.numberType||w.propsBadge.numberType,inverted:t.badge&&t.badge.inverted||w.propsBadge.inverted,customStyle:"margin-left: 4px;"},null,8,["show","isDot","value","max","type","showZero","bgColor","color","shape","numberType","inverted"])])),_:2},1032,["onClick","style","class"])))),128)),f($,{class:"uv-tabs__wrapper__nav__line",ref:"uv-tabs__wrapper__nav__line",style:u([{width:e.$uv.addUnit(e.lineWidth),transform:`translate(${c.lineOffsetLeft}px)`,transitionDuration:`${c.firstTime?0:e.duration}ms`,height:c.firstTime?0:e.$uv.addUnit(e.lineHeight),background:e.lineColor,backgroundSize:e.lineBgSize}])},null,8,["style"])])),_:1},8,["style"])])),_:1},8,["scroll-x","scroll-left"])])),_:1}),_(e.$slots,"right",{},void 0,!0)])),_:3})])),_:3},8,["style"])}],["__scopeId","data-v-da7392b4"]]),W=""+new URL("welfare-banner-Tdb_Ms-1.jpg",import.meta.url).href,j=B({__name:"index",setup(e){const t=w("300"),s=w(1),i=x([{id:1,reward:1,is_sign:!0},{id:2,reward:1},{id:3,reward:2},{id:4,reward:2},{id:5,reward:2},{id:6,reward:2},{id:7,reward:5}]),d=[{id:1,name:"全部"},{id:2,name:"零食"},{id:3,name:"百货"},{id:4,name:"电影票"},{id:5,name:"话费"},{id:6,name:"公益"},{id:7,name:"其他"},{id:8,name:"其他"}],u=x([{id:1,title:"超级大大电饭煲家用电饭煲",price:9.9,pic:"/static/icon/goods2.png"},{id:2,title:"超级大大电饭煲家用电饭煲",price:18.9,pic:"/static/icon/goods2.png"},{id:3,title:"超级大大电饭煲家用电饭煲",price:18.9,pic:"/static/icon/goods2.png"},{id:4,title:"超级大大电饭煲家用电饭煲",price:18.9,pic:"/static/icon/goods2.png"},{id:5,title:"超级大大电饭煲家用电饭煲",price:18.9,pic:"/static/icon/goods2.png"},{id:6,title:"超级大大电饭煲家用电饭煲",price:18.9,pic:"/static/icon/goods2.png"}]),_=e=>{console.log(e)};return(e,y)=>{const w=S,x=p,C=$,T=m,B=N(h("uv-tabs"),D);return a(),l(T,{class:"welfare-wrapper"},{default:r((()=>[f(T,{class:"welfare-banner"},{default:r((()=>[f(w,{class:"image",src:W,mode:"aspectFill"}),f(T,{class:"top-info"},{default:r((()=>[f(T,{class:"recycle-beans flex-center-center"},{default:r((()=>[f(x,{class:"num"},{default:r((()=>[n(o(t.value),1)])),_:1}),f(C,{class:"beans-icon"})])),_:1}),f(T,{class:"sign-block"},{default:r((()=>[f(T,{class:"sign-info flex-center-between"},{default:r((()=>[f(x,null,{default:r((()=>[n(" 我的回收豆: "),f(x,{class:"count"},{default:r((()=>[n(o(t.value),1)])),_:1})])),_:1}),f(x,null,{default:r((()=>[n(" 连续签到 "),f(x,{class:"count"},{default:r((()=>[n(o(s.value),1)])),_:1}),n(" 天 ")])),_:1})])),_:1}),f(T,{class:"sign-box flex-center-between"},{default:r((()=>[(a(!0),b(g,null,v(i,(e=>(a(),l(T,{class:"sign-item flex-center flex-column",key:e.id},{default:r((()=>[f(x,null,{default:r((()=>[n("+"+o(e.reward),1)])),_:2},1024),f(C,{class:"beans-icon"}),e.is_sign?(a(),l(C,{key:0,class:"correct-icon"})):c("",!0)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})])),_:1}),f(T,{class:"shop-block"},{default:r((()=>[f(T,{class:"menu"},{default:r((()=>[f(B,{list:d,onClick:_,lineColor:"#ffc904"})])),_:1}),f(T,{class:"shop-list flex-start-between flex-wrap"},{default:r((()=>[(a(!0),b(g,null,v(u,(e=>(a(),l(T,{class:"goods-item",key:e.id,onClick:t=>{return s=e.id,void k({url:`/pages/welfare/goods-detail/goods-detail?id=${s}`});var s}},{default:r((()=>[f(T,{class:"goods-pic"},{default:r((()=>[f(C,{class:"post-icon"}),f(w,{class:"image",src:e.pic,mode:""},null,8,["src"])])),_:2},1024),f(T,{class:"goods-info"},{default:r((()=>[f(T,{class:"goods-title text-overflow"},{default:r((()=>[n(o(e.title),1)])),_:2},1024),f(T,{class:"goods-price flex-center-between"},{default:r((()=>[f(x,null,{default:r((()=>[n("￥"+o(e.price),1)])),_:2},1024),f(x,{class:"tip"},{default:r((()=>[n("可使用回收豆抵扣")])),_:1})])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-6c00a92f"]]);export{j as default};
